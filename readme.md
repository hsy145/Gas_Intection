# ðŸ”¥ GCM-UNet: Infrared Gas Detection Network

[![PyTorch](https://img.shields.io/badge/PyTorch-1.12%2B-ee4c2c?logo=pytorch)](https://pytorch.org/)
[![Python](https://img.shields.io/badge/Python-3.9-3776ab?logo=python)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)
[![Gitee](https://img.shields.io/badge/Gitee-Repo-c71d23)](https://gitee.com/your-username/gas-detection)

> **åŸºäºŽå…¨å±€ä¸Šä¸‹æ–‡æ¨¡å— (GCM) ä¸Žé€šé“æ³¨æ„åŠ›é—¨æŽ§ (Channel AG) çš„çº¢å¤–æ°”ä½“å¼±ç›®æ ‡åˆ†å‰²ç½‘ç»œ**

## ðŸ“– é¡¹ç›®ä»‹ç» (Introduction)

æœ¬é¡¹ç›®é’ˆå¯¹çº¢å¤–æ°”ä½“æˆåƒä¸­**ç›®æ ‡ç‰¹å¾å¾®å¼±ã€èƒŒæ™¯å™ªå£°å¤æ‚**çš„é—®é¢˜ï¼Œæå‡ºäº†ä¸€ç§æ”¹è¿›çš„ U-Net æž¶æž„â€”â€”**GCM-UNet**ã€‚

ä¼ ç»Ÿçš„ U-Net åœ¨è·³è·ƒè¿žæŽ¥ï¼ˆSkip Connectionï¼‰ä¸­ç›´æŽ¥èžåˆç‰¹å¾ï¼Œå®¹æ˜“å¼•å…¥å¤§é‡èƒŒæ™¯å™ªå£°ã€‚æœ¬é¡¹ç›®å¼•å…¥äº†ä¸¤ä¸ªæ ¸å¿ƒæ”¹è¿›ï¼š
1.  **Global Context Module (GCM):** åœ¨ç“¶é¢ˆå±‚æ•èŽ·å…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚
2.  **Channel Attention Gate (AG):** åœ¨è·³è·ƒè¿žæŽ¥ä¸­å¼•å…¥é€šé“æ³¨æ„åŠ›æœºåˆ¶ï¼Œè‡ªåŠ¨ç­›é€‰æœ‰æ•ˆç‰¹å¾é€šé“ï¼ŒæŠ‘åˆ¶å™ªå£°ã€‚

---

## ðŸ—ï¸ ç½‘ç»œæž¶æž„ (Network Architecture)

### 1. æ•´ä½“æž¶æž„ (Overall Architecture)
å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒGCM-UNet åŸºäºŽ Encoder-Decoder ç»“æž„ã€‚æˆ‘ä»¬åœ¨ Encoder å’Œ Decoder ä¹‹é—´çš„è·³è·ƒè¿žæŽ¥è·¯å¾„ä¸ŠåµŒå…¥äº† AG æ¨¡å—ï¼Œå¹¶åœ¨æœ€æ·±å±‚ç‰¹å¾å¤„åµŒå…¥äº† GCM æ¨¡å—ã€‚

![GCM-UNet Architecture](./arch_overall.png)
*(å›¾ 2: GCM-UNet æ•´ä½“ç½‘ç»œæž¶æž„å›¾)*

### 2. æ ¸å¿ƒç»„ä»¶ Iï¼šå…¨å±€ä¸Šä¸‹æ–‡æ¨¡å— (Global Context Module, GCM)
GCM æ¨¡å—ä½äºŽç½‘ç»œçš„**ç“¶é¢ˆå±‚ (Bottleneck)**ï¼Œå¤„ç†åˆ†è¾¨çŽ‡æœ€ä½Žä½†è¯­ä¹‰ä¿¡æ¯æœ€å¼ºçš„ç‰¹å¾ã€‚
* **ä½œç”¨:** ä¼ ç»Ÿçš„å·ç§¯åªèƒ½å…³æ³¨å±€éƒ¨æ„Ÿå—é‡Žï¼ŒGCM é€šè¿‡å¼•å…¥å…¨å±€æ³¨æ„åŠ›æœºåˆ¶ï¼Œå»ºç«‹åƒç´ é—´çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚
* **ä¼˜åŠ¿:** èƒ½å¤Ÿå¢žå¼ºç½‘ç»œå¯¹æ°”ä½“äº‘å›¢æ•´ä½“å½¢æ€çš„æ„ŸçŸ¥èƒ½åŠ›ï¼Œå¼¥è¡¥å±€éƒ¨å·ç§¯çš„å±€é™æ€§ï¼Œä¸ºè§£ç å™¨æä¾›æ›´é²æ£’çš„å…¨å±€è¯­ä¹‰ç‰¹å¾ã€‚

### 3. æ ¸å¿ƒç»„ä»¶ IIï¼šé€šé“æ³¨æ„åŠ›é—¨æŽ§ (Channel Attention Gate, AG)
AG æ¨¡å—ä½äºŽ**è·³è·ƒè¿žæŽ¥ (Skip Connections)** å¤„ï¼Œç”¨äºŽå¤„ç†ç¼–ç å™¨ä¼ é€’è¿‡æ¥çš„æµ…å±‚ç‰¹å¾ã€‚
ä¸åŒäºŽä¼ ç»Ÿçš„ç©ºé—´æ³¨æ„åŠ›ï¼Œæˆ‘ä»¬è®¾è®¡äº†**åŸºäºŽé€šé“çš„æ³¨æ„åŠ›æœºåˆ¶**ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼š

* **å¤šè·¯ç‰¹å¾åŽ‹ç¼©:** åˆ©ç”¨ `AdaptiveMaxPool` å’Œ `AdaptiveAvgPool` å¹¶è¡Œæå–ç‰¹å¾çš„æ˜¾è‘—çº¹ç†ä¸ŽèƒŒæ™¯ä¿¡æ¯ã€‚
* **ç‰¹å¾é‡æ ¡å‡†:** é€šè¿‡å…±äº« MLP å­¦ä¹ é€šé“é—´çš„éžçº¿æ€§å…³ç³»ï¼Œç”Ÿæˆé€šé“æƒé‡ã€‚
* **æ•ˆæžœ:** å°±åƒä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œè‡ªåŠ¨è¯†åˆ«å¹¶ä¿ç•™åŒ…å«æ°”ä½“ç‰¹å¾çš„é€šé“ï¼Œ**æŠ‘åˆ¶èƒŒæ™¯å™ªå£°é€šé“**ï¼Œç¡®ä¿åªæœ‰æœ‰æ•ˆçš„ç©ºé—´ç»†èŠ‚è¢«èžåˆåˆ°è§£ç å™¨ä¸­ã€‚

## ðŸ› ï¸ çŽ¯å¢ƒä¾èµ– (Requirements)

æœ¬é¡¹ç›®å»ºè®®åœ¨æ‹¥æœ‰ NVIDIA GPU çš„çŽ¯å¢ƒä¸‹è¿è¡Œã€‚

* **System:** Windows / Linux
* **Python:** 3.8+
* **CUDA:** 11.x (Recommended for RTX 3090)

ä¸»è¦ä¾èµ–åº“ï¼š
```bash
torch>=1.12.0
torchvision>=0.13.0
numpy
opencv-python
matplotlib
tqdm